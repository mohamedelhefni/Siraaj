<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics JS SDK - Example</title>
    <script src="../sdk/analytics.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }

        .container {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
        }

        button {
            background: #8b5cf6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
            transition: background 0.2s;
        }

        button:hover {
            background: #7c3aed;
        }

        .section {
            margin: 30px 0;
            padding: 20px;
            background: #f9fafb;
            border-radius: 8px;
        }

        .section h3 {
            margin-top: 0;
            color: #374151;
        }

        input,
        textarea {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
        }

        .code {
            background: #1f2937;
            color: #e5e7eb;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            margin: 10px 0;
        }

        .info {
            background: #dbeafe;
            color: #1e40af;
            padding: 12px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 4px solid #3b82f6;
        }

        a {
            color: #8b5cf6;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üìä Analytics JavaScript SDK</h1>
        <p class="subtitle">Test the analytics tracking in your browser</p>

        <div class="info">
            <strong>Status:</strong> Analytics initialized and auto-tracking enabled
        </div>

        <!-- Installation -->
        <div class="section">
            <h3>üì¶ Installation</h3>
            <p>Include the analytics.js script in your HTML:</p>
            <div class="code">
                &lt;script src="analytics.js"&gt;&lt;/script&gt;
                &lt;script&gt;
                const analytics = new Analytics({
                apiUrl: 'http://localhost:8080',
                autoTrack: true,
                debug: true
                });
                &lt;/script&gt;
            </div>
        </div>

        <!-- Manual Events -->
        <div class="section">
            <h3>üéØ Track Custom Events</h3>
            <button onclick="trackCustomEvent()">Track Button Click</button>
            <button onclick="trackPurchase()">Track Purchase</button>
            <button onclick="trackSignup()">Track Signup</button>

            <div class="code" style="margin-top: 15px;">
                analytics.track('button_clicked', {
                button_id: 'subscribe_btn',
                page: '/pricing'
                });
            </div>
        </div>

        <!-- Page Views -->
        <div class="section">
            <h3>üìÑ Track Page Views</h3>
            <button onclick="trackPageView()">Track Page View</button>

            <div class="code" style="margin-top: 15px;">
                analytics.pageView();
                // or with custom URL
                analytics.pageView('/custom/path');
            </div>
        </div>

        <!-- User Identification -->
        <div class="section">
            <h3>üë§ Identify Users</h3>
            <input type="text" id="userId" placeholder="Enter user ID (e.g., user123)" />
            <button onclick="identifyUser()">Identify User</button>

            <div class="code" style="margin-top: 15px;">
                analytics.identify('user123', {
                email: 'user@example.com',
                name: 'John Doe',
                plan: 'premium'
                });
            </div>
        </div>

        <!-- Form Tracking -->
        <div class="section">
            <h3>üìù Track Form Submissions</h3>
            <form id="testForm" onsubmit="handleFormSubmit(event)">
                <input type="email" placeholder="Email" required />
                <textarea placeholder="Message" required></textarea>
                <button type="submit">Submit Form</button>
            </form>

            <div class="code" style="margin-top: 15px;">
                analytics.trackForm('contact_form', {
                form_type: 'contact',
                fields: ['email', 'message']
                });
            </div>
        </div>

        <!-- Error Tracking -->
        <div class="section">
            <h3>‚ùå Track Errors</h3>
            <button onclick="trackError()">Track Error</button>
            <button onclick="throwError()">Throw Test Error</button>

            <div class="code" style="margin-top: 15px;">
                analytics.trackError(new Error('Something went wrong'), {
                component: 'checkout',
                severity: 'high'
                });
            </div>
        </div>

        <!-- E-commerce Events -->
        <div class="section">
            <h3>üõí E-commerce Tracking</h3>
            <button onclick="trackAddToCart()">Add to Cart</button>
            <button onclick="trackCheckout()">Checkout Started</button>
            <button onclick="trackPurchaseComplete()">Purchase Complete</button>
        </div>

        <!-- Links -->
        <div class="section">
            <h3>üîó Test Link Tracking (auto-tracked)</h3>
            <a href="#" onclick="event.preventDefault()">Internal Link</a> |
            <a href="https://example.com" target="_blank">External Link</a>
        </div>

        <!-- Configuration -->
        <div class="section">
            <h3>‚öôÔ∏è Configuration Options</h3>
            <div class="code">
                const analytics = new Analytics({
                apiUrl: 'http://localhost:8080', // Your analytics server URL
                projectId: 'my-website', // Project identifier for multi-tenant
                autoTrack: true, // Auto-track page views, clicks, errors
                bufferSize: 10, // Buffer events before sending
                flushInterval: 30000, // Auto-flush every 30 seconds
                debug: true // Enable debug logging
                });
            </div>
        </div>

        <div class="info" style="margin-top: 30px;">
            <strong>üí° Tip:</strong> Open the browser console to see debug logs and check the Network tab to see events
            being sent to the server.
        </div>
    </div>

    <script>
        // Initialize Analytics
        const analytics = new Analytics({
            apiUrl: 'http://localhost:8080',
            projectId: 'YOOOOOOOOoo', // Specify your project ID
            autoTrack: true,
            bufferSize: 5,
            flushInterval: 30000,
            debug: true
        });

        // Track custom event
        function trackCustomEvent() {
            analytics.track('button_clicked', {
                button_id: 'custom_event_btn',
                page: window.location.pathname,
                timestamp: new Date().toISOString()
            });
            showNotification('Custom event tracked! Check the console.');
        }

        // Track purchase
        function trackPurchase() {
            analytics.track('purchase', {
                product_id: 'PROD-123',
                product_name: 'Premium Plan',
                amount: 99.99,
                currency: 'USD',
                quantity: 1
            });
            showNotification('Purchase event tracked!');
        }

        // Track signup
        function trackSignup() {
            analytics.track('signup', {
                method: 'email',
                plan: 'free',
                source: 'homepage'
            });
            showNotification('Signup event tracked!');
        }

        // Track page view
        function trackPageView() {
            analytics.pageView();
            showNotification('Page view tracked!');
        }

        // Identify user
        function identifyUser() {
            const userId = document.getElementById('userId').value;
            if (userId) {
                analytics.identify(userId, {
                    email: 'user@example.com',
                    name: 'Test User',
                    plan: 'premium',
                    signup_date: new Date().toISOString()
                });
                showNotification(`User ${userId} identified!`);
            } else {
                showNotification('Please enter a user ID', 'error');
            }
        }

        // Handle form submit
        function handleFormSubmit(event) {
            event.preventDefault();
            analytics.trackForm('testForm', {
                form_type: 'contact',
                fields: ['email', 'message']
            });
            showNotification('Form submission tracked!');
        }

        // Track error
        function trackError() {
            analytics.trackError(new Error('Test error'), {
                component: 'example_page',
                severity: 'medium',
                user_action: 'button_click'
            });
            showNotification('Error tracked!');
        }

        // Throw test error (will be auto-tracked)
        function throwError() {
            try {
                throw new Error('This is a test error that will be auto-tracked');
            } catch (e) {
                // Error will be caught by global error handler
                console.error(e);
            }
            showNotification('Test error thrown and tracked!');
        }

        // E-commerce tracking examples
        function trackAddToCart() {
            analytics.track('add_to_cart', {
                product_id: 'PROD-456',
                product_name: 'Awesome Product',
                category: 'Electronics',
                price: 49.99,
                quantity: 1,
                currency: 'USD'
            });
            showNotification('Add to cart tracked!');
        }

        function trackCheckout() {
            analytics.track('checkout_started', {
                cart_total: 149.97,
                item_count: 3,
                currency: 'USD',
                payment_method: 'credit_card'
            });
            showNotification('Checkout started tracked!');
        }

        function trackPurchaseComplete() {
            analytics.track('purchase_completed', {
                order_id: 'ORD-' + Date.now(),
                total: 149.97,
                currency: 'USD',
                items: [
                    { id: 'PROD-1', name: 'Product 1', price: 49.99, quantity: 1 },
                    { id: 'PROD-2', name: 'Product 2', price: 99.98, quantity: 2 }
                ],
                payment_method: 'credit_card',
                shipping_method: 'express'
            });
            showNotification('Purchase completed tracked!');
        }

        // Better notification system instead of alerts
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'error' ? '#ef4444' : '#10b981'};
                color: white;
                padding: 12px 20px;
                border-radius: 6px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                z-index: 1000;
                opacity: 0;
                transform: translateY(-20px);
                transition: all 0.3s ease;
                max-width: 300px;
                font-size: 14px;
            `;

            document.body.appendChild(notification);

            // Animate in
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateY(0)';
            }, 10);

            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateY(-20px)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
    </script>
</body>

</html>